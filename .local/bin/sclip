#!/bin/sh

# Dumb clipboard manager for tty

usage() {
	cat <<EOF
usage: ${0##*/} [option]

You can pipe into sclip in order to copy a text

  Options:
    -p                Print clipboard content to stdout
    -d                Delete clipboard content
    -o                Pipe the text inserted to stdout

    -h/--help         Print this help message

sclip is a simple clipboard manager intended for 
clip management on tty, with great flexibility.
EOF
exit 1
}
[ "$1" = "-h" ] || [ "$1" = "--help" ] && usage

mkdir -p "$HOME/.cache"

while getopts ':pdo' args; do
	case $args in
		p) cat "$HOME/.cache/clipboard"; exit ;;
		d) printf "" > "$HOME/.cache/clipboard"; exit ;;
		o) stdout="1" ;;
		:) printf "${0##*/}: option $OPTARG requires an argument\\n"; exit 1 ;;
		?) printf "${0##*/}: invalid option -- $OPTARG\\n" ; exit 1 ;;
	esac
done
cat > "$HOME/.cache/clipboard"
[ -z "$stdout" ] && exit 0
cat "$HOME/.cache/clipboard"; exit 0
